classDiagram
    class User {
        +String id PK
        +String email
        +String role "Values: admin, contributor, voter"
        +Int creation_reputation
        +Int contributor_reputation
    }

    class Universe {
        +String id PK
        +String name
        +Array~String~ root_axiom_ids "Pointers to the Axiom Registry"
    }

    class Axiom {
        +String id PK
        +String canonical_name "e.g., 'Commutativity'"
        +Array~String~ aliases "Tags/Synonyms: ['Abelian', 'Symmetric']"
        +String default_latex "e.g., a \cdot b = b \cdot a"
        +String author_id FK
        +Timestamp created_at
    }
    
    note for Axiom "The 'Concept' Library.\nStores unique definitions."

    class Node {
        +String id PK
        +String parent_id FK
        +String author_id FK
        
        +String axiom_id FK "LOGIC: Links to the Concept"
        +String display_latex "VISUAL: The Notation Override"
        
        +String status "Values: unverified, verified, contested, dead_end"
        
        +Array~String~ isomorphic_to_ids "Type 1 Iso: Different Axioms, Same System"
        
        %% --- NEW ADDITION START ---
        +String duplicate_of_id "Type 2 Iso: Pointer to the Survivor Node"
        +Boolean to_be_deleted "Deprecation Flag (Triggers Yellow Flash)"
        %% --- NEW ADDITION END ---
        
        +Int vote_count_green
        +Int vote_count_black
        +Int flag_count_yellow
    }

    class Vote {
        +String id PK
        +String node_id FK
        +String user_id FK
        +String type "Values: green, black"
        +Timestamp timestamp
    }
    
    class Flag {
        +String id PK
        +String type "Values: node_issue, axiom_duplicate, isomorphism, deprecation"
        
        +String target_node_id FK "If flagging a Node"
        +String target_axiom_id FK "If flagging an Axiom"
        
        +String reporter_id FK
        +String reason
        +String suggested_fix_latex "For Node Typos"
        
        +String duplicate_of_id "Points to Master Axiom (Merge) OR Isomorphic Node (Link)"
        
        +String status
    }
    
    class Theorem {
        +String id PK
        +String node_id FK
        +String statement_latex
        +String proof_latex
    }

    User "1" -- "*" Node : creates
    User "1" -- "*" Axiom : creates
    User "1" -- "*" Vote : casts
    User "1" -- "*" Flag : reports
    
    Axiom "1" -- "*" Node : defines
    Node "1" -- "*" Vote : has
    Node "1" -- "*" Flag : has